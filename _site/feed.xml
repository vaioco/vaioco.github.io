<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">Random stuff</title>
<generator uri="https://github.com/jekyll/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="/feed.xml" />
<link rel="alternate" type="text/html" href="" />
<updated>2016-01-24T03:51:26+01:00</updated>
<id>/</id>
<author>
  <name>Valerio Costamagna</name>
  <uri>/</uri>
  
</author>


  

<entry>
  <title type="html"><![CDATA[ART - Part I]]></title>
  <link rel="alternate" type="text/html" href="/art/art-part-i/" />
  <id>/art/art-part-i</id>
  <published>2016-01-24T02:44:52+01:00</published>
  <updated>2016-01-24T02:44:52+01:00</updated>
  <author>
    <name>Valerio Costamagna</name>
    <uri></uri>
    
  </author>
  <content type="html">
    &lt;h2 id=&quot;art-runtime&quot;&gt;ART runtime&lt;/h2&gt;
&lt;p&gt;Google has replaced (&lt;a href=&quot;https://android-review.googlesource.com/#/c/98553/&quot;&gt;AOSP commit&lt;/a&gt;) the Dalvik (DVM) runtime  with the ART runtime, Dalvik is no longer available from Android 5.0.&lt;br /&gt;
ART introduces Ahead-of-time (AOT) compilation, at installation time ART compiles applications using the on-device &lt;strong&gt;dex2oat&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;ART uses two new files formats:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;.ART: only one file, &lt;strong&gt;boot.art&lt;/strong&gt; in “/system/framework/&amp;lt;arch&amp;gt;”. Image file with a heap of preinitialized classes and objects&lt;/li&gt;
  &lt;li&gt;.OAT: Master file &lt;strong&gt;boot.oat&lt;/strong&gt; in “/system/framework/&amp;lt;arch&amp;gt;”. Compiled application will be saved as OAT file.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;dex2oat utility takes a DEX file as input and produces an OAT file as output, the compiled application is device-dependent. The resulting OAT file will be generated inside the “/data/dalvik-cache/&amp;lt;arch&amp;gt;” folder, where &amp;lt;arch&amp;gt; is the target architecture of the compilation. (i.e. architecture of the device).&lt;/p&gt;

&lt;p&gt;OAT file format is developed by Google, it is embedded into an ELF file format. It contains DEX code, compiled native code and metadata. OAT files are loaded into application like a shared object.&lt;/p&gt;

&lt;p&gt;Android framework JARs are compiled at the first device boot, the resulting files are &lt;em&gt;boot.art&lt;/em&gt;, the &lt;strong&gt;image file&lt;/strong&gt;, and &lt;em&gt;boot.oat&lt;/em&gt;. The image file is placed in memory right before the &lt;strong&gt;boot.oat&lt;/strong&gt;, which links to it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/file_formats.png&quot; alt=&quot;My helpful screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Runtime flow is pictured into the following image:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/runtime_flow.png&quot; alt=&quot;asd&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;art-data-structures&quot;&gt;ART Data Structures&lt;/h2&gt;
&lt;p&gt;The ART Data Structures (ADS) useful for our interests are the following:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Class (&lt;a href=&quot;http://androidxref.com/6.0.1_r10/xref/art/runtime/mirror/class.h&quot;&gt;androidxref&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ArtMethod (&lt;a href=&quot;http://androidxref.com/6.0.1_r10/xref/art/runtime/art_method.h&quot;&gt;androidxref&lt;/a&gt;)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The &lt;em&gt;Class&lt;/em&gt; data structure define the layout of a Java class, the following two members are used for looking up virtual methods:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1220&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Virtual method table (vtable), for use by &amp;quot;invoke-virtual&amp;quot;.  The vtable from the superclass is&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1221&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// copied in, and virtual methods from our class either replace those from the super or are&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1222&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// appended. For abstract classes, methods may be created in the vtable that aren&amp;#39;t in&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1223&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// virtual_ methods_ for miranda methods.&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1224&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;HeapReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PointerArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vtable_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1246&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Virtual methods defined in this class; invoked through vtable. Pointer to an ArtMethod array.&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1247&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtual_methods_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;em&gt;vtable_&lt;/em&gt; is a reference to an array of pointers. Each element is a pointer to methods defined inside that class and methods from the superclass. Instead, virtual_methods__ is a reference to an array of pointers to methods defined only inside that class, each element is an &lt;em&gt;ArtMethod&lt;/em&gt; type.&lt;/p&gt;

&lt;p&gt;The type used to represent a Java method is called &lt;em&gt;ArtMethod&lt;/em&gt;, its iteresting elements are the following:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;544&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;GcRoot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;declaring_class_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;552&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Access flags; low 16 bits are defined by spec.&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;553&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;uint32_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_flags_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;565&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Entry within a dispatch table for this method. For static/direct methods the index is into&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;566&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// the declaringClass.directMethods, for virtual methods the vtable and for interface methods the&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;567&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// ifTable.&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;568&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;uint32_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_index_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;declaring_class_&lt;/em&gt;,line 544, is a reference to the class which define the method. The &lt;em&gt;access_flags_&lt;/em&gt; is used for set the class visibility (public, static, native, interface, etc..) and _method_index_ value contains the method’s index value inside the vtable.&lt;/p&gt;

&lt;p&gt;Before starting the real fun, let me introduce my envinronment.&lt;/p&gt;

&lt;h3 id=&quot;be-comfortable-with-the-environment&quot;&gt;Be comfortable with the environment&lt;/h3&gt;

&lt;p&gt;I suggest to you to use Ubuntu for building from AOSP ( or debian is likely as well). I used a Nexus6 with AOSP, y running version at the writing time is XXX&lt;/p&gt;

&lt;p&gt;The requirements are the following:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Android SDK&lt;/li&gt;
  &lt;li&gt;Android NDK&lt;/li&gt;
  &lt;li&gt;device/emulator with AOSP build (refer to &lt;a href=&quot;https://source.android.com/source/initializing.html&quot;&gt;building AOSP&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I will use GDB as debugger, radare is a very good alternative, and the symbols taken from the AOSP build.&lt;br /&gt;
Be comfortable means uses scripts for simplify your exploration, first create a directory with links to the symbols you need. For our purposes we need the following symbols:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;72&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:46 app_process32 -&amp;gt; symbols/system/bin/app_process32
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;76&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 libandroidfw.so -&amp;gt; symbols/system/lib/libandroidfw.so
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;88&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 libandroid_runtime.so -&amp;gt; symbols/system/lib/libandroid_runtime.so
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;64&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 libart.so -&amp;gt; symbols/system/lib/libart.so
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;60&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:44 libc.so -&amp;gt; symbols/system/lib/libc.so
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;70&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 libcutils.so -&amp;gt; symbols/system/lib/libcutils.so
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;64&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 liblog.so -&amp;gt; symbols/system/lib/liblog.so
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;70&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:44 libstdc++.so -&amp;gt; symbols/system/lib/libstdc++.so
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;68&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 libutils.so -&amp;gt; symbols/system/lib/libutils.so
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt; lrwxrwxrwx &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; root root   &lt;span class=&quot;m&quot;&gt;58&lt;/span&gt; gen &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; 15:45 linker -&amp;gt; symbols/system/bin/linker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The following GDB script will set the debugging session options&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; target remote :1337
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;solib-search-path .&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The port 1337 will be used for connecting to the debugger instance running on the device, we have to forward the port with the adb utility running the following command:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; adb forward tcp:1337 tcp:1337&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;debugging-for-fun-and-profit&quot;&gt;Debugging for fun and profit&lt;/h3&gt;

&lt;p&gt;A Java class loaded in memory has a structure looks like the following one:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x70377fc0&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; 	&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;members&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kImtSize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;class_loader_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;direct_methods_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArtMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x700ec788&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;name_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;18&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6faf33c8&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;19&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;20&lt;/span&gt;  	&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;21&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;virtual_methods_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;22&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArtMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;23&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x700ed158&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;24&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;25&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;vtable_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;26&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ObjectArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;art&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArtMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;27&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;28&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;   
&lt;span class=&quot;lineno&quot;&gt;29&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;access_flags_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;30&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;class_size_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x604&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;31&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;num_reference_instance_fields_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;32&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;num_reference_static_fields_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;33&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;object_size_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;34&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;status_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;35&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;36&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;virtual_methods_&lt;/em&gt; is a reference to an “art::mirror::ObjectArray&lt;art::mirror::artmethod&gt; &amp;gt;&amp;gt;&quot;, an array of ArtMethods objects.&lt;/art::mirror::artmethod&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; p/x &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;art::mirror::Class *&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;0x7110bf10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-&amp;gt;virtual_methods_
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt;   &amp;lt;art::mirror::ObjectReference&amp;lt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;, art::mirror::ObjectArray&amp;lt;art::mirror::ArtMethod&amp;gt; &amp;gt;&amp;gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;reference_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x70e7b3c8
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;, &amp;lt;No data fields&amp;gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The following code show its structure from memory:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; p/x *&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;art::mirror::ObjectArray&amp;lt;art::mirror::ArtMethod&amp;gt;*&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0x70e7b3c8
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt;   &amp;lt;art::mirror::Array&amp;gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; 	&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt;     members of art::mirror::Array: 
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;length_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x280, 
&lt;span class=&quot;lineno&quot;&gt;7&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;first_element_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x70e7b3d4
&lt;span class=&quot;lineno&quot;&gt;8&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;, &amp;lt;No data fields&amp;gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;hooking-virtual-methods-for-profit&quot;&gt;Hooking virtual methods for profit&lt;/h3&gt;

&lt;p&gt;What do you need for hooking Java virtual methods?&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;new Java method memory address&lt;/li&gt;
  &lt;li&gt;original method’s (target) reference and his position inside the virtual-table array&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;We can leaverage the JNI mechanism to get the target method address&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;754&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ShouldHaveEmbeddedImtAndVTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SHARED_LOCKS_REQUIRED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Locks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mutator_lock_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;755&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IsInstantiable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;756&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;454&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;IsInstantiable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SHARED_LOCKS_REQUIRED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Locks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mutator_lock_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;455&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsPrimitive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsAbstract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;456&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsAbstract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IsArrayClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;457&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;458&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://census-labs.com/media/Fuzzing_Objects_d_ART_hitbsecconf2015ams_WP.pdf&quot;&gt;asd&lt;/a&gt;&lt;br /&gt;
https://www.blackhat.com/docs/asia-15/materials/asia-15-Sabanal-Hiding-Behind-ART-wp.pdf&lt;br /&gt;
http://newandroidbook.com/files/Andevcon-ART.pdf&lt;br /&gt;
https://conference.hitb.org/hitbsecconf2014ams/materials/D1T2-State-of-the-Art-Exploring-the-New-Android-KitKat-Runtime.pdf&lt;br /&gt;
https://www.quora.com/What-are-the-technical-details-of-the-Android-ART-runtime-introduced-in-Android-4-4&lt;br /&gt;
Android Internals: A Confectioner’s Cookbook (Jonathan Levin)&lt;br /&gt;
http://www.kandroid.org/board/data/board/conference/file_in_body/1/14th_kandroid_minmax_v11.pdf&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/art/art-part-i/&quot;&gt;ART - Part I&lt;/a&gt; was originally published by Valerio Costamagna at &lt;a href=&quot;&quot;&gt;Random stuff&lt;/a&gt; on January 24, 2016.&lt;/p&gt;
  </content>
</entry>

</feed>
